
const php = require('klesun-node-tools/src/Transpiled/php.js');
const FareRuleParser = require("../../../../../../../backend/Transpiled/Gds/Parsers/Amadeus/Pricing/FareRuleParser");

class FareRuleParserTest extends require('klesun-node-tools/src/Transpiled/Lib/TestCase.js') {
	provideDumps() {
		let $list;

		$list = [];

		// apollo>*PVK4WC; full dump
		$list.push([
			php.implode(php.PHP_EOL, [
				'FQN1',
				'',
				' 1 - PSGR P1 ADT                                   RULES DISPLAY',
				'FARE COMPONENT  1    ADT MWZJNB KQ  TSRWTZ',
				'FCL: TSRWTZ    TRF:  31 RULE: TZ11 BK:  T',
				'PTC: ADT-ADULT              FTC: XOX-ONE WAY SPECIAL EXCURSION',
				'RU.RULE APPLICATION',
				'KQ ECONOMY CLASS FARES',
				' APPLICATION',
				'   AREA',
				'     THESE FARES APPLY',
				'     WITHIN AREA 2.',
				'   CLASS OF SERVICE',
				'     THESE FARES APPLY FOR ECONOMY CLASS SERVICE.',
				'   TYPES OF TRANSPORTATION',
				'     THIS RULE GOVERNS ONE-WAY AND ROUND-TRIP FARES.',
				'     FARES GOVERNED BY THIS RULE CAN BE USED TO CREATE',
				'     ONE-WAY/ROUND-TRIP/SINGLE OPEN-JAW/DOUBLE OPEN-JAW',
				'     JOURNEYS.',
				'   ALL FARES ARE SUBJECT TO CHANGE OR WITHDRAWAL',
				'   WITHOUT NOTICE.  FARES ARE GUARANTEED IF AUTO',
				'',
				'   PRICED AND TICKETED IN THE GDS ON THE SAME DAY.',
				'   TICKETS ARE NOT TRANSFERABLE',
				'',
				'MN.MIN STAY',
				'  NONE UNLESS OTHERWISE SPECIFIED',
				'',
				'MX.MAX STAY',
				'',
				'  TRAVEL FROM LAST STOPOVER MUST COMMENCE NO LATER THAN 12',
				'  MONTHS AFTER DEPARTURE FROM FARE ORIGIN.',
				'',
				'SR.SALES RESTRICT',
				'',
				'  TICKETS MUST BE ISSUED ON KQ  OR KL AND MAY NOT BE SOLD IN',
				'  SOUTH SUDAN/ANGOLA/NIGERIA AND MAY ONLY BE SOLD IN AREA 1/',
				'  AREA 2/AREA 3',
				'  TICKETS MAY BE ISSUED BY PTA/ELECTRONIC TICKETING.',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR AF AND MAY NOT BE',
				'       SOLD IN SOUTH SUDAN/ANGOLA/NIGERIA AND MAY ONLY BE',
				'       SOLD IN AREA 1/AREA 2/AREA 3',
				'       TICKETS MAY BE ISSUED BY PTA/ELECTRONIC TICKETING.',
				'',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR PW AND MAY NOT BE',
				'       SOLD IN SOUTH SUDAN/ANGOLA/NIGERIA AND MAY ONLY BE',
				'       SOLD IN AREA 1/AREA 2/AREA 3',
				'       TICKETS MAY BE ISSUED BY PTA/ELECTRONIC TICKETING.',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR HR AND MAY NOT BE',
				'       SOLD IN SOUTH SUDAN/ANGOLA/NIGERIA AND MAY ONLY BE',
				'       SOLD IN AREA 1/AREA 2/AREA 3',
				'       TICKETS MAY BE ISSUED BY PTA/ELECTRONIC TICKETING.',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR YO AND MAY NOT BE',
				'       SOLD IN SOUTH SUDAN/ANGOLA/NIGERIA AND MAY ONLY BE',
				'       SOLD IN AREA 1/AREA 2/AREA 3',
				'       TICKETS MAY BE ISSUED BY PTA/ELECTRONIC TICKETING.',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR DL AND MAY NOT BE',
				'       SOLD IN SOUTH SUDAN/ANGOLA/NIGERIA AND MAY ONLY BE',
				'       SOLD IN AREA 1/AREA 2/AREA 3',
				'       TICKETS MAY BE ISSUED BY PTA/ELECTRONIC TICKETING.',
				'',
				'TR.TVL RESTRICTION',
				'',
				'  VALID FOR TRAVEL COMMENCING ON/AFTER 01MAR 12.',
				'',
				'AP.ADVANCE RES/TKT',
				'',
				'  RESERVATIONS ARE REQUIRED FOR ALL SECTORS.',
				'         NOTE -',
				'          ELECTRONIC TICKETING ONLY',
				'          ---',
				'          TICKETING REQUIRED AS PER THE TICKETING TIME LIMIT',
				'          AND ADVANCE PURCHASE RULE IF APPLICABLE.',
				'          THE MORE RESTRICTIVE TICKETING DEADLINE APPLIES.',
				'          ---',
				'          IF A TICKET IS USED OUT OF SEQUENCE KQ RESERVES',
				'          THE RIGHT TO CANCEL THE PNR AND INVALIDATE TICKET',
				'          FOR THE REMAINING SECTORS.',
				'          ---',
				'          IF A PASSENGER FAILS TO TRAVEL ON A SECTOR BOOKED',
				'          KQ RESERVES THE RIGHT TO CANCEL REMAINING KQ',
				'          SECTORS.',
				'          ---',
				'          IF A PASSENGER HOLDS MULTIPLE RESERVATIONS ON',
				'          THE SAME SECTOR ON MULTIPLE FLIGHTS OR DATES',
				'          WHERE IT IS LOGICALLY IMPOSSIBLE TO TRAVEL ALL',
				'',
				'          SECTORS',
				'          KQ RESERVES THE RIGHT TO CANCEL ALTERNATIVE',
				'          SECTORS',
				'',
				'FL.FLT APPLICATION',
				'  NONE UNLESS OTHERWISE SPECIFIED',
				'',
				'',
				'CD.CHILD DISCOUNTS',
				'FROM/TO EAST AFRICA FOR ONE WAY FARES',
				'',
				'  ACCOMPANIED CHILD 2-11 - CHARGE 75 PERCENT OF THE FARE.',
				'        TICKET DESIGNATOR - CH AND PERCENT OF DISCOUNT.',
				'    MUST BE ACCOMPANIED ON ALL FLIGHTS IN SAME COMPARTMENT',
				'      BY ADULT 18 OR OLDER',
				'  OR - INFANT UNDER 2 WITH A SEAT - CHARGE 75 PERCENT OF THE',
				'         FARE.',
				'             TICKET DESIGNATOR - CH AND PERCENT OF DISCOUNT.',
				'         MUST BE ACCOMPANIED ON ALL FLIGHTS IN SAME',
				'           COMPARTMENT BY ADULT 18 OR OLDER',
				'  OR - INFANT UNDER 2 WITHOUT A SEAT - CHARGE 10 PERCENT OF',
				'',
				'         THE FARE.',
				'             TICKET DESIGNATOR - IN AND PERCENT OF DISCOUNT.',
				'         MUST BE ACCOMPANIED ON ALL FLIGHTS IN SAME',
				'           COMPARTMENT BY ADULT 18 OR OLDER.',
				'',
				'  IF THE FARE COMPONENT IS ON',
				'      ONE OR MORE OF THE FOLLOWING',
				'        ANY KQ FLIGHT OPERATED BY KQ',
				'      ON DIRECT FLIGHTS',
				'  UNACCOMPANIED CHILD 5-14. ID REQUIRED - CHARGE 100 PERCENT',
				'    OF THE FARE PLUS USD 25.00.',
				'        TICKET DESIGNATOR - UM0.',
				'         NOTE -',
				'          OW DIRECT FLIGHT WITHOUT TRANSFER - USD 25',
				'',
				'  UNACCOMPANIED CHILD 5-14. ID REQUIRED - CHARGE 100 PERCENT',
				'         OF THE FARE PLUS USD 50.00.',
				'             TICKET DESIGNATOR - UM0.',
				'         NOTE -',
				'          OW FLIGHTS WITH TRANSFER -----------------USD 50',
				'',
				'TC.TOUR CONDUCTOR',
				'',
				'         NOTE -',
				'          TOUR CONDUCTORS DISCOUNTS NOT PERMITTED.',
				'',
				'AD.AGTS DISCOUNTS',
				'',
				'         NOTE -',
				'          AGENT DISCOUNTS NOT PERMITTED.',
				'',
				'SO.STOPOVERS',
				'FOR TSRWTZ TYPE FARES',
				'',
				'  UNLIMITED STOPOVERS PERMITTED ON THE PRICING UNIT',
				'     LIMITED TO 1 FREE AND UNLIMITED AT USD 100.00 EACH.',
				'',
				'SU.SURCHARGES',
				'',
				'  THE PROVISIONS BELOW APPLY ONLY AS FOLLOWS -',
				'  TICKETS MAY ONLY BE SOLD IN ANGOLA.',
				'    A SURCHARGE OF 222 PERCENT OF THE FARE PER TICKET WILL',
				'',
				'    BE ADDED TO THE APPLICABLE FARE FOR TRAVEL.',
				'',
				'  THE PROVISIONS BELOW APPLY ONLY AS FOLLOWS -',
				'  TICKETS MAY ONLY BE SOLD IN NIGERIA.',
				'    A SURCHARGE OF 50 PERCENT OF THE FARE PER TICKET WILL BE',
				'    ADDED TO THE APPLICABLE FARE FOR TRAVEL.',
				'',
				'  THE PROVISIONS BELOW APPLY ONLY AS FOLLOWS -',
				'  TICKETS MUST BE ISSUED ON KQ  OR KL.',
				'  TICKETS MAY BE ISSUED BY ELECTRONIC TICKETING.',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR AF.',
				'       TICKETS MAY BE ISSUED BY ELECTRONIC TICKETING.',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR PW.',
				'       TICKETS MAY BE ISSUED BY ELECTRONIC TICKETING.',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR HR.',
				'       TICKETS MAY BE ISSUED BY ELECTRONIC TICKETING.',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR YO.',
				'       TICKETS MAY BE ISSUED BY ELECTRONIC TICKETING.',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR DL.',
				'       TICKETS MAY BE ISSUED BY ELECTRONIC TICKETING.',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR WB.',
				'',
				'       TICKETS MAY BE ISSUED BY ELECTRONIC TICKETING.',
				'  OR - TICKETS MUST BE ISSUED ON KQ  OR BP.',
				'       TICKETS MAY BE ISSUED BY ELECTRONIC TICKETING.',
				'    THERE IS NO CHARGE FOR TRAVEL PER COUPON.',
				'',
				'  OTHERWISE',
				'    A SURCHARGE OF USD 110.00 PER COUPON WILL BE ADDED TO',
				'    THE APPLICABLE FARE FOR TRAVEL.',
				'',
				'TE.TKT ENDORSEMENT',
				'',
				'  THE ORIGINAL TICKET MUST BE ANNOTATED - NONENDO/',
				'  NONTRANSFERABLE - AND - RESTRICTIONS APPLY - IN THE',
				'  ENDORSEMENT BOX.',
				'',
				'',
				'PE.PENALTIES',
				'FOR TSRWTZ TYPE FARES',
				'',
				'  CHANGES',
				'',
				'    BEFORE DEPARTURE',
				'      CHARGE USD 50.00.',
				'         NOTE -',
				'          PENALTY APPLIES FOR EACH REISSUE/REVALIDATION FOR',
				'          CHANGE IN FLIGHT/DATE/ROUTING AND ANY APPLICABLE',
				'          NO-SHOW FEE. PENALTY FEES ARE NOT',
				'          COMMISSIONABLE.',
				'',
				'    AFTER DEPARTURE',
				'      CHARGE USD 100.00.',
				'         NOTE -',
				'          PENALTY APPLIES FOR EACH REISSUE/REVALIDATION FOR',
				'          CHANGE IN FLIGHT/DATE/ROUTING AND ANY APPLICABLE',
				'          NO-SHOW FEE. PENALTY FEES ARE NOT',
				'          COMMISSIONABLE.',
				'',
				'    ANY TIME',
				'      CHARGE USD 100.00 FOR NO-SHOW.',
				'      WAIVED FOR DEATH OF PASSENGER.',
				'         NOTE -',
				'          NO SHOW FEE APPLIES IF THE PASSENGER IS A NO SHOW',
				'',
				'          ON ANY FLIGHT SEGMENT. WAIVED FOR DEATH OF',
				'          PASSENGER.   NO-SHOW FEES ARE NOT COMMISSIONABLE',
				'          NO-SHOW DEFINATION - A PASSENGER FAILS TO',
				'          CHANGE/CANCEL HIS/HER RESERVATIONS BEFORE',
				'          DEPARTURE OF THE FLIGHT',
				'',
				'  CANCELLATIONS',
				'',
				'    BEFORE DEPARTURE',
				'      CHARGE USD 100.00 FOR REFUND.',
				'      WAIVED FOR DEATH OF PASSENGER.',
				'         NOTE -',
				'          FREE TEXT -',
				'          CANCELLATION FEE APPLIES IF THE FARE COMPONENT IS',
				'          REFUNDED PLUS ANY APPLICABLE NO-SHOW',
				'          PENALTY.',
				'          WAIVED FOR DEATH OF PASSENGER.',
				'          CANCELLATION/REFUND/NO-SHOW FEES ARE NOT',
				'          COMMISSIONABLE',
				'          -------------------------------------------------',
				'',
				'    AFTER DEPARTURE',
				'      TICKET IS NON-REFUNDABLE IN CASE OF REFUND.',
				'      WAIVED FOR DEATH OF PASSENGER.',
				'         NOTE -',
				'          AFTER DEPARTURE TICKET IS NON REFUNDABLE. WAIVED',
				'          FOR DEATH OF PASSENGER.  YQ/YR IS NOT',
				'          REFUNDABLE. .',
				'          ------------------------------------------------',
				'          AFTER DEPARTURE - REFUNDS FOR RETURN PORTIONS OF',
				'          TICKETS MUST NOT BE REFUNDED EARLIER THAN 07 DAYS',
				'          AFTER ARRIVAL IN MPM/APL/POL/LLW/BLZ',
				'          --------------------------------------------------',
				'',
				'CO.COMBINABILITY',
				'   APPLICABLE ADD-ON CONSTRUCTION IS ADDRESSED IN',
				'   MISCELLANEOUS PROVISIONS - CATEGORY 23.',
				'  END-ON-END',
				'    END-ON-END COMBINATIONS PERMITTED. VALIDATE ALL FARE',
				'    COMPONENTS. SIDE TRIPS PERMITTED.',
				'   PROVIDED -',
				'     COMBINATIONS ARE FOR CARRIER KQ/KL/PW/HR/YO/DL/AF',
				'',
				'  OPEN JAWS',
				'    FARES MAY BE COMBINED ON A HALF ROUND TRIP BASIS',
				'    -TO FORM SINGLE OR DOUBLE OPEN JAWS.',
				'     MILEAGE OF THE OPEN SEGMENT MUST BE EQUAL/LESS THAN',
				'     MILEAGE OF THE LONGEST FLOWN FARE COMPONENT.',
				'   PROVIDED -',
				'     WHEN THE OPEN SEGMENT OCCURS',
				'      -WITHIN AREA 2',
				'       COMBINATIONS ARE WITH ANY FARE FOR CARRIER KQ/AF/PW/',
				'     HR/YO/DL/KL IN ANY RULE AND TARIFF.',
				'  ROUND TRIPS/CIRCLE TRIPS',
				'    FARES MAY BE COMBINED ON A HALF ROUND TRIP BASIS',
				'    -TO FORM ROUND TRIPS/CIRCLE TRIPS.',
				'   PROVIDED -',
				'     COMBINATIONS ARE WITH ANY FARE FOR CARRIER KQ/KL/PW/AF/',
				'     DL/HR/YO IN ANY RULE AND TARIFF.',
				'',
				'MD.MISCELLANEOUS DATA',
				'',
				'  THIS FARE MAY BE USED FOR ADD-ON CONSTRUCTION.',
				'',
				'VC.VOLUNTARY CHANGES',
				'FOR TSRWTZ TYPE FARES',
				'',
				'  IN THE EVENT OF CHANGES TO TICKETED FLIGHTS',
				'   BEFORE DEPARTURE OF JOURNEY - APPLIES WITHIN TKT VALIDITY',
				'    CERTAIN DOMESTIC REISSUE PROVISIONS MAY BE OVERRIDDEN BY',
				'    THOSE OF KQ  INTERNATIONAL FARES',
				'     CHARGE USD 50.00 FOR REISSUE OR HIGHEST FEE OF ALL FARE',
				'     COMPONENTS - DISCOUNTS APPLY - NO FEE FOR INFANTS W/O',
				'     SEAT AND',
				'      REPRICE USING FARES IN EFFECT WHEN TKT WAS ISSUED',
				'       PROVIDED ALL OF THE FOLLOWING CONDITIONS ARE MET-',
				'       1. NO CHANGE TO 1ST FLIGHT COUPON',
				'       2. WHEN NO INTL COUPONS REMAIN - ALL NEW TRAVEL MUST',
				'       BE DOMESTIC',
				'       3. CHANGE IS BEFORE ORIGINAL SCHEDULED FLIGHT',
				'       4. KQ  FARES ARE USED',
				'       5. NEW TKT HAS EQUAL OR HIGHER VALUE THAN PREVIOUS',
				'       TKT',
				'       6. ALL RULE AND BOOKING CODE PROVISIONS ARE MET',
				'       7. ADV RES IS MEASURED FROM REISSUE DATE TO DEPARTURE',
				'',
				'       OF PRICING UNIT',
				'      OR -',
				'      REPRICE USING FARES IN EFFECT TODAY',
				'       PROVIDED ALL OF THE FOLLOWING CONDITIONS ARE MET-',
				'       1. WHEN NO INTL COUPONS REMAIN - ALL NEW TRAVEL MUST',
				'       BE DOMESTIC',
				'       2. CHANGE IS BEFORE ORIGINAL SCHEDULED FLIGHT',
				'       3. KQ  FARES ARE USED',
				'       4. NEW TKT HAS EQUAL OR HIGHER VALUE THAN PREVIOUS',
				'       TKT',
				'       5. ADV RES IS MEASURED FROM ORIGINAL TKT DATE TO',
				'       DEPARTURE OF PRICING UNIT',
				'       6. TKT REISSUE MUST BE COMPLETED SAME DAY OF',
				'       DEPARTURE',
				'   WHEN CHANGE RESULTS IN LOWER FARE IGNORE RESIDUAL THEN',
				'   ADD-COLLECT - REFUND VIA VOUCHER',
				'   ENDORSEMENT BOX- HIGHER NON-REF AMT AND NEW ENDORSEMENTS.',
				'  OR -',
				'   BEFORE DEPARTURE OF JOURNEY - APPLIES WITHIN TKT VALIDITY',
				'    IN THE CASE OF DEATH OF PASSENGER OR FAMILY MEMBER -',
				'    CERTAIN DOMESTIC REISSUE PROVISIONS MAY BE OVERRIDDEN BY',
				'',
				'    THOSE OF KQ  INTERNATIONAL FARES',
				'     CHARGE USD 100.00 FOR REISSUE OR HIGHEST FEE OF ALL',
				'     FARE COMPONENTS - DISCOUNTS APPLY - NO FEE FOR INFANTS',
				'     W/O SEAT AND',
				'      REPRICE USING FARES IN EFFECT TODAY',
				'       PROVIDED ALL OF THE FOLLOWING CONDITIONS ARE MET-',
				'       1. WHEN NO INTL COUPONS REMAIN - ALL NEW TRAVEL MUST',
				'       BE DOMESTIC',
				'       2. CHANGE IS AFTER ORIGINAL SCHEDULED FLIGHT',
				'       3. KQ  FARES ARE USED',
				'       4. NEW TKT HAS EQUAL OR HIGHER VALUE THAN PREVIOUS',
				'       TKT',
				'       5. ADV RES IS MEASURED FROM ORIGINAL TKT DATE TO',
				'       DEPARTURE OF PRICING UNIT',
				'   WHEN CHANGE RESULTS IN LOWER FARE IGNORE RESIDUAL THEN',
				'   ADD-COLLECT - REFUND VIA VOUCHER',
				'   ENDORSEMENT BOX- HIGHER NON-REF AMT AND NEW ENDORSEMENTS.',
				'  OR -',
				'   AFTER DEPARTURE OF JOURNEY - APPLIES WITHIN TKT VALIDITY',
				'    CERTAIN DOMESTIC REISSUE PROVISIONS MAY BE OVERRIDDEN BY',
				'    THOSE OF KQ  INTERNATIONAL FARES',
				'',
				'     CHARGE USD 100.00 FOR REISSUE OR HIGHEST FEE OF ALL',
				'     FARE COMPONENTS - DISCOUNTS APPLY - NO FEE FOR INFANTS',
				'     W/O SEAT AND',
				'      REPRICE USING FARES IN EFFECT WHEN TKT WAS ISSUED',
				'       PROVIDED ALL OF THE FOLLOWING CONDITIONS ARE MET-',
				'       1. NO CHANGE TO 1ST FLIGHT COUPON',
				'       2. WHEN NO INTL COUPONS REMAIN - ALL NEW TRAVEL MUST',
				'       BE DOMESTIC',
				'       3. FULLY FLOWN FARE NOT REPRICED TO FURTHER POINT',
				'       4. CHANGE IS BEFORE ORIGINAL SCHEDULED FLIGHT',
				'       5. KQ  FARES ARE USED',
				'       6. NEW TKT HAS EQUAL OR HIGHER VALUE THAN PREVIOUS',
				'       TKT',
				'       7. ALL RULE AND BOOKING CODE PROVISIONS ARE MET',
				'       8. ADV RES IS MEASURED FROM REISSUE DATE TO DEPARTURE',
				'       OF PRICING UNIT',
				'      OR -',
				'      REPRICE USING FARES IN EFFECT TODAY',
				'       PROVIDED ALL OF THE FOLLOWING CONDITIONS ARE MET-',
				'       1. WHEN NO INTL COUPONS REMAIN - ALL NEW TRAVEL MUST',
				'       BE DOMESTIC',
				'',
				'       2. FULLY FLOWN FARE NOT REPRICED TO FURTHER POINT',
				'       3. CHANGE IS BEFORE ORIGINAL SCHEDULED FLIGHT',
				'       4. KQ  FARES ARE USED',
				'       5. NEW TKT HAS EQUAL OR HIGHER VALUE THAN PREVIOUS',
				'       TKT',
				'       6. ADV RES IS MEASURED FROM REISSUE DATE TO DEPARTURE',
				'       OF PRICING UNIT',
				'       7. TKT REISSUE MUST BE COMPLETED SAME DAY OF',
				'       DEPARTURE',
				'   WHEN CHANGE RESULTS IN LOWER FARE IGNORE RESIDUAL THEN',
				'   ADD-COLLECT - REFUND VIA VOUCHER',
				'   ENDORSEMENT BOX- HIGHER NON-REF AMT AND NEW ENDORSEMENTS.',
				'  OR -',
				'   AFTER DEPARTURE OF JOURNEY - APPLIES WITHIN TKT VALIDITY',
				'    IN THE CASE OF DEATH OF PASSENGER OR FAMILY MEMBER -',
				'    CERTAIN DOMESTIC REISSUE PROVISIONS MAY BE OVERRIDDEN BY',
				'    THOSE OF KQ  INTERNATIONAL FARES',
				'     CHARGE USD 100.00 FOR REISSUE OR HIGHEST FEE OF ALL',
				'     FARE COMPONENTS - DISCOUNTS APPLY - NO FEE FOR INFANTS',
				'     W/O SEAT AND',
				'      REPRICE USING FARES IN EFFECT TODAY',
				'',
				'       PROVIDED ALL OF THE FOLLOWING CONDITIONS ARE MET-',
				'       1. WHEN NO INTL COUPONS REMAIN - ALL NEW TRAVEL MUST',
				'       BE DOMESTIC',
				'       2. FULLY FLOWN FARE NOT REPRICED TO FURTHER POINT',
				'       3. CHANGE IS AFTER ORIGINAL SCHEDULED FLIGHT',
				'       4. KQ  FARES ARE USED',
				'       5. NEW TKT HAS EQUAL OR HIGHER VALUE THAN PREVIOUS',
				'       TKT',
				'       6. ADV RES IS MEASURED FROM REISSUE DATE TO DEPARTURE',
				'       OF PRICING UNIT',
				'   WHEN CHANGE RESULTS IN LOWER FARE IGNORE RESIDUAL THEN',
				'   ADD-COLLECT',
				'   ENDORSEMENT BOX- HIGHER NON-REF AMT AND NEW ENDORSEMENTS.',
				'',
				'VR.VOLUNTARY REFUNDS',
				'FOR TSRWTZ TYPE FARES',
				'',
				'  REFER TO PENALTIES CATEGORY 16',
				'',
			]),
			{
				'type': 'rulesDisplay',
				'pricingPaxNum': '1',
				'data': {
					'fareComponent': {
						'componentNumber': '1',
						'ptc': 'ADT',
						'departureCity': 'MWZ',
						'destinationCity': 'JNB',
						'airline': 'KQ',
						'fareBasis': 'TSRWTZ',
					},
					'header': {
						'fareBasis': 'TSRWTZ',
						'trf': '31',
						'rule': 'TZ11',
						'bookingClass': 'T',
						'ptc': 'ADT',
						'ptcMeaning': 'ADULT',
						'fareType': 'XOX',
						'tripTypeRemark': 'ONE WAY SPECIAL EXCURSION',
					},
					'sections': [
						{'abbreviation': 'RU', 'sectionName': 'RULE APPLICATION'},
						{'abbreviation': 'MN', 'sectionName': 'MIN STAY', 'raw': '  NONE UNLESS OTHERWISE SPECIFIED'},
						{
							'abbreviation': 'MX', 'sectionName': 'MAX STAY', 'raw': php.implode(php.PHP_EOL, [
								'  TRAVEL FROM LAST STOPOVER MUST COMMENCE NO LATER THAN 12',
								'  MONTHS AFTER DEPARTURE FROM FARE ORIGIN.',
							]),
							'parsed': null,
						},
						{'abbreviation': 'SR', 'sectionName': 'SALES RESTRICT'},
						{
							'abbreviation': 'TR',
							'sectionName': 'TVL RESTRICTION',
							'raw': '  VALID FOR TRAVEL COMMENCING ON/AFTER 01MAR 12.'
						},
						{'abbreviation': 'AP', 'sectionName': 'ADVANCE RES/TKT'},
						{'abbreviation': 'FL', 'sectionName': 'FLT APPLICATION'},
						{'abbreviation': 'CD', 'sectionName': 'CHILD DISCOUNTS'},
						{'abbreviation': 'TC', 'sectionName': 'TOUR CONDUCTOR'},
						{'abbreviation': 'AD', 'sectionName': 'AGTS DISCOUNTS'},
						{'abbreviation': 'SO', 'sectionName': 'STOPOVERS'},
						{'abbreviation': 'SU', 'sectionName': 'SURCHARGES'},
						{'abbreviation': 'TE', 'sectionName': 'TKT ENDORSEMENT'},
						{'abbreviation': 'PE', 'sectionName': 'PENALTIES', 'parsed': null},
						{'abbreviation': 'CO', 'sectionName': 'COMBINABILITY'},
						{'abbreviation': 'MD', 'sectionName': 'MISCELLANEOUS DATA'},
						{'abbreviation': 'VC', 'sectionName': 'VOLUNTARY CHANGES'},
						{'abbreviation': 'VR', 'sectionName': 'VOLUNTARY REFUNDS'},
					],
				},
			},
		]);

		// apollo>*PVK4WC;
		$list.push([
			php.implode(php.PHP_EOL, [
				'FQN1',
				'',
				' 1 - PSGR P1 IN                                    RULES DISPLAY',
				'FARE COMPONENT  1    INF MWZJNB KQ  TSRWTZ',
				'FCL: TSRWTZ    TRF:  31 RULE: TZ11 BK:  T',
				'PTC: INF-INFANT NOT OCCUPYI FTC: XOX-ONE WAY SPECIAL EXCURSION',
				'MN.MIN STAY',
				'  NONE UNLESS OTHERWISE SPECIFIED',
				'',
				// rest sections truncated
			]),
			{
				'type': 'rulesDisplay',
				'pricingPaxNum': '1',
				'data': {
					'fareComponent': {
						'componentNumber': '1',
						'ptc': 'INF',
						'departureCity': 'MWZ',
						'destinationCity': 'JNB',
						'airline': 'KQ',
						'fareBasis': 'TSRWTZ',
					},
					'header': {
						'fareBasis': 'TSRWTZ',
						'trf': '31',
						'rule': 'TZ11',
						'bookingClass': 'T',
						'ptc': 'INF',
						'ptcMeaning': 'INFANT NOT OCCUPYI',
						'fareType': 'XOX',
						'tripTypeRemark': 'ONE WAY SPECIAL EXCURSION',
					},
					'sections': [
						{'abbreviation': 'MN', 'sectionName': 'MIN STAY', 'raw': '  NONE UNLESS OTHERWISE SPECIFIED'},
					],
				},
			},
		]);

		// apollo>*V1WWKC;
		$list.push([
			php.implode(php.PHP_EOL, [
				'FQN1',
				'',
				' 1 - PSGR P1 IN                                    RULES DISPLAY',
				'FARE COMPONENT  1    INF KGLDOH QR  NJR1R1RI',
				'FCL: NJR1R1RI  TRF:  34 RULE: RY02 BK:  N',
				'PTC: INF-INFANT NOT OCCUPYI FTC: ER -ECONOMY RESTRICTED',
				'MN.MIN STAY',
				'  NONE UNLESS OTHERWISE SPECIFIED',
				'',
				// rest sections truncated
			]),
			{
				'type': 'rulesDisplay',
				'pricingPaxNum': '1',
				'data': {
					'fareComponent': {
						'componentNumber': '1',
						'ptc': 'INF',
						'departureCity': 'KGL',
						'destinationCity': 'DOH',
						'airline': 'QR',
						'fareBasis': 'NJR1R1RI',
					},
					'header': {
						'fareBasis': 'NJR1R1RI',
						'trf': '34',
						'rule': 'RY02',
						'bookingClass': 'N',
						'ptc': 'INF',
						'ptcMeaning': 'INFANT NOT OCCUPYI',
						'fareType': 'ER',
						'tripTypeRemark': 'ECONOMY RESTRICTED',
					},
					'sections': [
						{'abbreviation': 'MN', 'sectionName': 'MIN STAY', 'raw': '  NONE UNLESS OTHERWISE SPECIFIED'},
					],
				},
			},
		]);

		// apollo>*X3LFBQ; multiple components in single ptc pricing
		$list.push([
			php.implode(php.PHP_EOL, [
				'FQN1',
				'',
				'1 - PSGR P1 IN',
				' FQN 1-1    INF WASDLA ET  ULPRUS',
				' FQN 1-2    INF YAOWAS ET  QLPRUS',
			]),
			{
				'type': 'componentList',
				'pricingPaxNum': '1',
				'data': [
					{
						'command': 'FQN 1-1',
						'componentNumber': '1',
						'ptc': 'INF',
						'departureCity': 'WAS',
						'destinationCity': 'DLA',
						'airline': 'ET',
						'fareBasis': 'ULPRUS',
					},
					{
						'command': 'FQN 1-2',
						'componentNumber': '2',
						'ptc': 'INF',
						'departureCity': 'YAO',
						'destinationCity': 'WAS',
						'airline': 'ET',
						'fareBasis': 'QLPRUS',
					},
				],
			},
		]);

		// apollo>*X3LFBQ; same, but called from a multi-ptc pricing
		$list.push([
			php.implode(php.PHP_EOL, [
				'FQN2',
				'',
				'2 - PSGR P1-2 ADT',
				' FQN 2-1    ADT WASDLA ET  ULPRUS',
				' FQN 2-2    ADT YAOWAS ET  QLPRUS',
				// '                                                  PAGE  1/ 1',
			]),
			{
				'type': 'componentList',
				'pricingPaxNum': '2',
				'paxNumbers': [1, 2],
				'ptc': 'ADT',
				'data': [
					{'componentNumber': '1', 'fareBasis': 'ULPRUS'},
					{'componentNumber': '2', 'fareBasis': 'QLPRUS'},
				],
			},
		]);

		// apollo>*X3LFBQ; name number 2, but pricing pax number is 3, because it is infant assigned to name #2
		$list.push([
			php.implode(php.PHP_EOL, [
				'FQN3',
				'',
				'3 - PSGR P2 IN',
				' FQN 3-1    INF WASDLA ET  ULPRUS',
				' FQN 3-2    INF YAOWAS ET  QLPRUS',
				// '                                                  PAGE  1/ 1',
			]),
			{
				'type': 'componentList',
				'pricingPaxNum': '3',
				'paxNumbers': [2],
				'ptc': 'IN',
				'data': [
					{'componentNumber': '1', 'fareBasis': 'ULPRUS'},
					{'componentNumber': '2', 'fareBasis': 'QLPRUS'},
				],
			},
		]);

		// apollo>*X3LFBQ; single component from multi-component screen
		$list.push([
			php.implode(php.PHP_EOL, [
				'FQN2-2',
				'',
				' 2 - PSGR P1 IN                                    RULES DISPLAY',
				'FARE COMPONENT  2    INF YAOWAS ET  QLPRUS',
				'FCL: QLPRUS    TRF:   1 RULE: PRUS BK:  Q',
				'PTC: INF-INFANT NOT OCCUPYI FTC: XAN-NON REFUNDABLE APEX',
				'MN.MIN STAY',
				'FOR QLPRUS TYPE FARES',
				'',
				'  TRAVEL FROM LAST STOPOVER MUST COMMENCE NO EARLIER THAN 3',
				'  DAYS AFTER DEPARTURE FROM FARE ORIGIN.',
				'',
				'MX.MAX STAY',
				'FOR QLPRUS TYPE FARES   NOTE - GENERAL RULE DOES NOT APPLY',
				'',
				'  TRAVEL FROM LAST STOPOVER MUST COMMENCE NO LATER THAN 3',
				'  MONTHS AFTER DEPARTURE FROM FARE ORIGIN.',
				'',
				// rest truncated
			]),
			{
				'type': 'rulesDisplay',
				'pricingPaxNum': '2',
				'paxNumbers': [1],
				'data': {
					'fareComponent': {
						'componentNumber': '2',
						'ptc': 'INF',
						'departureCity': 'YAO',
						'destinationCity': 'WAS',
						'airline': 'ET',
						'fareBasis': 'QLPRUS',
					},
					'header': {
						'fareBasis': 'QLPRUS',
						'trf': '1',
						'rule': 'PRUS',
						'bookingClass': 'Q',
						'ptc': 'INF',
						'ptcMeaning': 'INFANT NOT OCCUPYI',
						'fareType': 'XAN',
						'tripTypeRemark': 'NON REFUNDABLE APEX',
					},
					'sections': [
						{
							'abbreviation': 'MN', 'sectionName': 'MIN STAY',
							'raw': php.implode(php.PHP_EOL, [
								'FOR QLPRUS TYPE FARES',
								'',
								'  TRAVEL FROM LAST STOPOVER MUST COMMENCE NO EARLIER THAN 3',
								'  DAYS AFTER DEPARTURE FROM FARE ORIGIN.',
							]),
							'parsed': null,
						},
						{
							'abbreviation': 'MX', 'sectionName': 'MAX STAY',
							'raw': php.implode(php.PHP_EOL, [
								'FOR QLPRUS TYPE FARES   NOTE - GENERAL RULE DOES NOT APPLY',
								'',
								'  TRAVEL FROM LAST STOPOVER MUST COMMENCE NO LATER THAN 3',
								'  MONTHS AFTER DEPARTURE FROM FARE ORIGIN.',
							]),
							'parsed': null,
						},
					],
				},
			},
		]);

		$list.push([
			php.implode(php.PHP_EOL, [
				'FQN1*6,7,8,16',
				'',
				'1 - PTC 1/6-6 ADT',
				' FQN 1-1    ADT KIVRIX SU  YFO               FF : EF',
				' FQN 1-2    ADT RIXTYO LO  Y1RED',
				'                                                  PAGE  1/ 1',
				' ',
			]),
			{
				'type': 'componentList',
				'pricingPaxNum': '1',
				'paxNumberType': 'commandPtc',
				'paxNumbers': [1, 6],
				'ptc': 'ADT',
				'data': [
					{'componentNumber': '1', 'departureCity': 'KIV', 'destinationCity': 'RIX', 'fareBasis': 'YFO'},
					{'componentNumber': '2', 'departureCity': 'RIX', 'destinationCity': 'TYO', 'fareBasis': 'Y1RED'},
				],
			},
		]);

		return $list;
	}

	/**
	 * @test
	 * @dataProvider provideDumps
	 */
	testParser($dump, $expected) {
		let $actual;

		$actual = FareRuleParser.parse($dump);
		this.assertArrayElementsSubset($expected, $actual);
	}

	getTestMapping() {
		return [
			[this.provideDumps, this.testParser],
		];
	}
}

module.exports = FareRuleParserTest;
